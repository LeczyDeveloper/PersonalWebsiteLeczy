(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+/sI":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("ERkP"),s=n("TGcR"),r=n("t62R"),i=n("a6qo"),o=n("rHpw");const c="animated_gif",d="video";class u extends a.PureComponent{render(){const{durationInMilliseconds:e,type:t}=this.props;let n;if(t===c||"vine"===t)n=t===c?a.createElement(r.c,{weight:"bold"},"GIF"):a.createElement(s.a,{style:l.icon});else if(t===d&&e){const t=Math.trunc(e/6e4),s=("0"+Math.trunc(e%6e4/1e3)).slice(-2);n=a.createElement(r.c,{color:"white"},`${t}:${s}`)}return n?a.createElement(i.a,{align:"left"},n):null}}const l=o.a.create(e=>({icon:{color:e.colors.white}}));t.c=u},"/Imo":function(e,t,n){"use strict";n("kYxP");var a=n("97Jx"),s=n.n(a),r=n("LdEA"),i=n.n(r),o=n("KEM+"),c=n.n(o),d=n("ERkP"),u=n("/yvb"),l=n("k/Ka"),_=n("rHpw");class p extends d.Component{constructor(...e){super(...e),c()(this,"_handlePress",e=>{const{onPress:t}=this.props;t&&t(e),this._fileInput&&this._fileInput.click()}),c()(this,"_handleChange",e=>{const{onChange:t}=this.props,n=e.target,a=n.files;a.length&&t&&t(a),n.value=""}),c()(this,"_handleFileInputButtonRef",e=>{this._fileInput=e})}render(){const e=this.props,{accept:t,disabled:n,multiple:a,testID:r}=e,o=i()(e,["accept","disabled","multiple","onChange","testID"]);return d.createElement(d.Fragment,null,d.createElement(u.a,s()({},o,{disabled:n,onPress:this._handlePress})),Object(l.a)("input",{accept:t,disabled:n,multiple:a,onChange:this._handleChange,ref:this._handleFileInputButtonRef,style:m.input,tabIndex:-1,testID:r,type:"file"}))}}c()(p,"defaultProps",{disabled:!1,multiple:!1});const m=_.a.create(e=>({input:{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1}}));t.a=p},"07FG":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("cnVF");const s=e=>e===a.v},"3A2y":function(e,t,n){"use strict";var a=n("zrOZ");t.a=(e,t)=>{const n=Object(a.a)(Array.isArray(t)?t:[t]);return Object.keys(e).reduce((t,a)=>(n.has(a)||(t[a]=e[a]),t),{})}},"4q8G":function(e,t,n){"use strict";var a=n("t0aI");t.a=({sort_event_id:e},{sort_event_id:t})=>e?t?Object(a.a)(t,e):1:-1},"7myi":function(e,t,n){"use strict";n("kYxP");var a=n("KEM+"),s=n.n(a),r=n("ERkP"),i=n("oEoC"),o=n("2dXj"),c=n("GZwR");class d extends r.Component{constructor(...e){super(...e),s()(this,"_genericWrapperRef",r.createRef()),s()(this,"state",{queryContext:void 0,canShowTypeahead:!1}),s()(this,"render",()=>{const{contextText:e,children:t,isInline:n,onTypeaheadStateChange:a,source:s}=this.props,{queryContext:i,canShowTypeahead:d}=this.state,u=d&&i?{word:i.word,resultType:i.resultType}:void 0;return r.createElement(o.a,{contextText:e,isInline:n,onDismiss:this._handleDismiss,onSelectItem:this._handleSelectItem,onTypeaheadStateChange:a,query:u,ref:this._genericWrapperRef,source:s||c.d.Compose},t(this._handleInputChange))}),s()(this,"_handleSelectItem",e=>{const{onTextUpdated:t}=this.props,{queryContext:n}=this.state;if(n){const a="users"===n.resultType&&"user"===e.type?`@${e.data.screen_name} `:(e.data.topic||e.data.text||"")+" ",{newCursor:s,newTweetText:r}=this._replaceToken(a,n);t({target:{value:r}}),this._updateDOMTextArea(s,r)}this._setQueryContext(void 0)}),s()(this,"_updateDOMTextArea",(e,t)=>{this._textAreaRef&&(this._textAreaRef.value=t,this._textAreaRef.selectionStart=e,this._textAreaRef.selectionEnd=e,this._textAreaRef.focus())}),s()(this,"_handleInputChange",e=>{const t=e&&(e.currentTarget||e.target),{queryContext:n}=this.state;this._textAreaRef=t;const a=n&&n.word,s=t.value,{word:r,start:o,end:c}=i.c(t.selectionStart,s),d=i.d(r||"","compose");if((null==d?void 0:d.q)!==a)if(this._genericWrapperRef.current&&this._genericWrapperRef.current.resetSelectedItem(),-1===o)this._setQueryContext(void 0);else if(d){const{q:e,result_type:n}=d;this._setQueryContext({word:e,resultType:n,fullText:t.value,startIndex:o,endIndex:c})}else this._setQueryContext(void 0)}),s()(this,"_setQueryContext",e=>this.setState({queryContext:e,canShowTypeahead:!!e})),s()(this,"_handleDismiss",()=>this.setState({canShowTypeahead:!1}))}_replaceToken(e,t){const{fullText:n,startIndex:a,endIndex:s}=t,r=n.slice(0,a);return{newTweetText:r+e+n.slice(s),newCursor:r.length+e.length}}}t.a=d},KqB4:function(e,t,n){"use strict";var a=n("IGGJ");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=[],a=(0,s.default)(e,t),r=0;r<a.length;r++)n.push(a[r].url);return n};var s=a(n("vwfs"));e.exports=t.default},LCtV:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));n("kYxP");var a=n("KEM+"),s=n.n(a),r=n("ERkP"),i=n("3XMw"),o=n.n(i),c=n("mN6z"),d=n("Qwev"),u=n("rHpw"),l=n("1auM"),_=n("ude7"),p=n("U+bB"),m=n("MWbm");const b=o.a.gff1f69e,E=Object.freeze({INFINITE:"infinite",MEDIUM:"medium",NONE:"none"});class O extends r.Component{constructor(...e){super(...e),s()(this,"state",{imagePreviewUrl:null}),s()(this,"_getImageSrc",()=>{const{mediaItem:e,enableGif:t}=this.props,{imagePreviewUrl:n}=this.state;if(e&&e.mediaFile)return e.mediaFile.isGif&&!t?n:e.mediaFile.url})}componentDidUpdate(){const{enableGif:e,mediaItem:{mediaFile:t}}=this.props,{imagePreviewUrl:n}=this.state;e||n||t instanceof l.a&&t.isGif&&Object(_.a)(t).then(e=>{this.setState({imagePreviewUrl:e})})}shouldComponentUpdate(e,t){return!Object(c.a)(e,this.props)||!Object(c.a)(t,this.state)}render(){const{borderRadius:e,enableGif:t,mediaItem:n,onClick:a}=this.props,{imagePreviewUrl:s}=this.state||{},i=n.mediaFile&&n.mediaFile.isGif&&!t&&!s,o=n.needsProcessing||i,c=[f.root,I[e],o&&f.loadingBorder],u=this._getImageSrc();return r.createElement(m.a,{onClick:a,style:c},o||!u?r.createElement(d.a,{accessibilityLabel:b,style:f.activityIndicator}):r.createElement(p.a,{resizeMode:"cover",source:u,style:f.image}))}}s()(O,"defaultProps",{borderRadius:E.NONE,enableGif:!0});const I=u.a.create(e=>({[E.INFINITE]:{borderRadius:e.borderRadii.infinite},[E.MEDIUM]:{borderRadius:e.borderRadii.small},[E.NONE]:{borderRadius:e.borderRadii.none}})),f=u.a.create(e=>({root:{borderRadius:e.borderRadii.xLarge,borderStyle:"solid",borderWidth:e.borderWidths.none,borderColor:"transparent",maxWidth:"100%",height:"100%",overflow:"hidden"},image:{display:"block",height:"100%",width:"100%"},loadingBorder:{borderColor:e.colors.gray300},activityIndicator:{height:"100%"}}));t.b=O},MLl7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return r}));const a=Object.freeze({Composition:"composition",DMComposition:"dm_composition"}),s=e=>Object.values(a).indexOf(e)>=0,r=(e,t)=>"boolean"==typeof e?e:t},VPdC:function(e,t,n){"use strict";n.d(t,"b",(function(){return g}));var a=n("97Jx"),s=n.n(a),r=n("LdEA"),i=n.n(r),o=n("KEM+"),c=n.n(o),d=n("ERkP"),u=n("3XMw"),l=n.n(u),_=n("cjZk"),p="fileInput",m=n("sjK1"),b=n("/Imo"),E=n("rHpw"),O=n("9HgX");const I=l.a.b9960f31,f=d.createElement(_.a,null),g=({acceptGifs:e,acceptVideo:t})=>O.b.concat(e?[O.a]:[]).concat(t?m.a:[]);class h extends d.PureComponent{render(){const e=this.props,{acceptGifs:t,acceptVideo:n,style:a}=e,r=i()(e,["acceptGifs","acceptVideo","style"]),o=g({acceptGifs:t,acceptVideo:n}).join(",");return d.createElement(b.a,s()({},r,{accept:o,style:[y.root,a],testID:p}))}}c()(h,"defaultProps",{acceptGifs:!0,acceptVideo:!0,accessibilityLabel:I,icon:f,size:"normal"});const y=E.a.create(e=>({root:{margin:"-"+e.spaces.xSmall}}));t.a=h},VnFT:function(e,t,n){"use strict";n.d(t,"n",(function(){return v})),n.d(t,"m",(function(){return S})),n.d(t,"f",(function(){return j})),n.d(t,"d",(function(){return R})),n.d(t,"g",(function(){return D})),n.d(t,"e",(function(){return M})),n.d(t,"i",(function(){return P})),n.d(t,"j",(function(){return w})),n.d(t,"l",(function(){return U})),n.d(t,"h",(function(){return L})),n.d(t,"k",(function(){return V})),n.d(t,"a",(function(){return B})),n.d(t,"o",(function(){return G})),n.d(t,"b",(function(){return H})),n.d(t,"c",(function(){return W}));n("IAdD"),n("JtPf"),n("DZ+c"),n("kYxP");var a=n("LdEA"),s=n.n(a),r=n("AspN"),i=n("xPna"),o=n("oEOe"),c=n("xCUF"),d=n("ude7"),u=n("07FG"),l=n("Ssj5"),_=n("fEA7"),p=n.n(_),m=n("uKEd"),b=n("lnti"),E=n("/NU0");const O=e=>"rweb/multiDraftDMs/"+e,I={};const f=e=>{const{conversation_id:t,id:n,localMediaId:a,recipient_ids:s,sender_id:r,text:i,attachment:o={},error:c}=e,d=Date.now().toString();return{conversation_id:t,recipient_ids:s,error:c,id:n,is_draft:!0,message_data:{attachment:o,localMediaId:a,sender_id:r,text:i,time:d},type:"message",time:d}},g=O("SEND_MESSAGE_REQUEST"),h=O("SEND_MESSAGE_SUCCESS"),y=O("SEND_MESSAGE_FAILURE"),v=e=>(t,n,{api:a})=>{const l=e||{},{senderId:_,cardUrl:O,conversationId:I,localMediaId:v,recipients:A=[],requestId:S=p.a.v1(),tweetAttachment:T,quickReply:j}=l,C=s()(l,["senderId","cardUrl","conversationId","localMediaId","recipients","requestId","tweetAttachment","quickReply"]);t(Y(I));const D=n(),N=v||x(n(),I),[M]=r.g(D,N),{mediaFile:P}=M||{},w=A.length>0&&A.join(","),U={};P&&P.isGif?U.extraInitParams="&media_category=dm_gif":P&&P.isVideo&&(U.extraInitParams="&media_category=dm_video");const k=r.k(N,U),B=[t(k)],F=L(D,I),{found_media_origin:G}=F||{},q=V(D,I);return P&&P.isGif&&B.push(Object(d.a)(P)),Promise.all(B).then(([[n],s])=>{const d=q&&Object.keys(q).length&&q[n.id]&&(q[n.id].altText||q[n.id].defaultAltText),l=!!d;return(n&&(G||l)?t(r.i(Object.assign({media_id:n.uploadId,found_media_origin:G},!!l&&{alt_text:{text:d}}))):Promise.resolve()).then(()=>{const{id_str:r}=T||{},d={};if(n){const{mediaFile:e={}}=n,t={original_info:{width:e.width,height:e.height},sizes:[{h:e.height,w:e.width,resize:"fit"}]};e.isImage?d.photo=Object.assign({},t,{media_url_https:e.url}):e.isGif?d.animated_gif=Object.assign({},t,{media_url_https:s,type:"animated_gif"}):e.isVideo&&(d.video=Object.assign({},t,{media_url_https:e.url,type:"video"}))}else T&&(d.tweet={status:r});const{uploadId:l}=n||{},p=f({attachment:d,conversation_id:I,id:S,recipient_ids:w,sender_id:_,text:e.text}),v=Object.assign({},C,Object(u.a)(O)&&{card_uri:O},{conversation_id:I,media_id:l,recipient_ids:w,request_id:S,tweet_id:r});j&&(v["quick_reply_response[options][id]"]=j.id,v["quick_reply_response[options][selected_id]"]=j.selected_id);const A=Object(b.a)([J(I),{type:c.c.REQUEST},{type:g},I&&Object(m.b)(I,S,p)]);return t(A),a.DirectMessages.sendMessage(v).then(n=>{const{entries:a,users:s,tweets:r,cards:o}=n.entities,{conversations:d}=n.result;Object(E.a)(N)&&t(W(I,N));const u=Object(b.a)([{type:c.c.SUCCESS},...Object(i.c)({conversations:d,entries:a,users:s,tweets:r,cards:o}),{type:h},I&&Object(m.j)(I,S,e),R(I)]);return t(u),Promise.resolve(Object.values(n.entities.entries)[0].conversation_id)},n=>{const a=f({attachment:d,conversation_id:I,error:!0,id:S,localMediaId:N,recipient_ids:w,sender_id:_,text:e.text}),s=Object(b.a)([{type:c.c.SUCCESS},{type:y},I&&Object(m.b)(I,S,a)]);return t(s),Object(o.e)(t,n,"ACTION_SEND_DM")})},e=>(t($(I)),e.type="metadata",Promise.reject(e)))},e=>(t(Object(b.a)([Object(E.a)(N)&&W(I,N),$(I)])),Promise.reject(e)))},A=(e,t)=>e.multiDraftDMs[t],S=(e,t)=>{const n=A(e,t);return n?n.text:null},T=O("SAVE_TEXT"),j=(e,t)=>({type:T,conversationId:e,text:t}),C=O("REMOVE_TEXT"),R=e=>({type:C,conversationId:e}),D=(e,t)=>{const n=A(e,t);return n?n.cardUrl:null},N=O("SAVE_CARD_URL"),M=(e,t)=>({type:N,conversationId:e,cardUrl:t}),x=(e,t)=>{const n=A(e,t);return n?n.mediaId:null},P=(e,t)=>{const n=r.g(e,x(e,t));return n.length>0?n[0]:null},w=(e,t)=>{const n=A(e,t);return!!n&&n.isUploading},U=(e,t)=>r.h(e,x(e,t)),L=(e,t)=>{const n=A(e,t);return n?n.gifMetadata:null},V=(e,t)=>{const n=A(e,t);return n?n.mediaMetadata:void 0},k=O("ADD_MEDIA"),B=(e,[t],n,a)=>({payload:{isUploading:!1,mediaId:t,gifMetadata:n,mediaMetadata:a},type:k,conversationId:e}),F=O("UPDATE_MEDIA_METADATA"),G=(e,t)=>({payload:t,type:F,conversationId:e}),q=O("CANCEL_UPLOAD"),H=e=>({type:q,conversationId:e}),K=O("REMOVE_MEDIA"),z=e=>({type:K,conversationId:e}),W=(e,t)=>n=>{n(r.e(t)),n([H(e),z(e)])},Q=O("UPLOAD_REQUEST"),Y=e=>({type:Q,conversationId:e}),X=O("UPLOAD_SUCCESS"),J=e=>({type:X,conversationId:e}),Z=O("UPLOAD_FAILURE"),$=e=>({type:Z,conversationId:e});l.a.register({multiDraftDMs:function(e=I,t){const n=t.conversationId||"new_group";switch(t.type){case F:case k:{const a=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},a,t.payload)})}case Q:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},t,{isUploading:!0})})}case q:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},t,{isUploading:!1})})}case Z:case X:case K:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},t,{isUploading:!1,mediaId:null,mediaMetadata:void 0,gifMetadata:void 0})})}case T:{const a=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},a,{text:t.text})})}case N:{const a=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},a,{cardUrl:t.cardUrl})})}case C:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return Object.assign({},e,{[n]:Object.assign({},t,{text:null})})}default:return e}}})},WVrH:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var a=n("AQ79");const s=Object(a.c)("RESET"),r=()=>({type:s})},aWyx:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i}));const a=Object.freeze({ONE_TO_ONE:"ONE_TO_ONE",GROUP:"GROUP_DM"}),s=Object.freeze({AT_END:"AT_END",HAS_MORE:"HAS_MORE"}),r=Object.freeze({CONVERSATION_AVATAR_UPDATE:"conversation_avatar_update",CONVERSATION_NAME_UPDATE:"conversation_name_update",CONVERSATION_PROFILE_INFO_HEADER:"conversation_profile_info_header",CONVERSATION_READ:"conversation_read",CONVO_METADATA_UPDATE:"convo_metadata_update",DISABLE_NOTIFICATIONS:"disable_notifications",ENABLE_NOTIFICATIONS:"enable_notifications",JOIN_CONVERSATION:"join_conversation",MARK_ALL_AS_READ:"mark_all_as_read",MENTION_NOTIFICATIONS_UPDATE:"mention_notifications_setting_update",MESSAGE:"message",MESSAGE_DELETE:"message_delete",MESSAGE_MARK_AS_NOT_SPAM:"message_unmark_as_spam",MESSAGE_MARK_AS_SPAM:"message_mark_as_spam",PARTICIPANTS_JOIN:"participants_join",PARTICIPANTS_LEAVE:"participants_leave",REACTION_CREATE:"reaction_create",REACTION_DELETE:"reaction_delete",READ_ONLY_INDICATOR:"read_only_indicator",REMOVE_CONVERSATION:"remove_conversation",TRUST_CONVERSATION:"trust_conversation",TYPING_INDICATOR:"typing_indicator",WELCOME_MESSAGE:"welcome_message_create"}),i=Object.freeze({MUTUAL_FRIENDS:"mutual_friends"})},cIoY:function(e,t,n){"use strict";var a=n("ERkP"),s=n("1YZw"),r=n("rxPX"),i=Object(r.a)().propsFromActions(()=>({addToast:s.b})),o=n("KEM+"),c=n.n(o),d=(n("jQ/y"),n("kYxP"),n("k/Ka")),u=n("3XMw"),l=n.n(u),_=n("sgih"),p=n("t62R"),m=n("/yvb"),b=n("rHpw");const E=l.a.cfd2f35d;class O extends a.Component{constructor(...e){super(...e),c()(this,"_handleOnFocus",e=>{e.currentTarget.select()})}render(){const{cancelButtonLabel:e,description:t,headerText:n,link:s,onCancel:r}=this.props,i=Object(d.a)("input",{autoFocus:!0,onFocus:this._handleOnFocus,readOnly:!0,style:I.linkInput,value:s});return a.createElement(_.a,{onMaskClick:r,style:I.container,type:"center",withMask:!0},n&&a.createElement(p.c,{align:"center",color:"normal",style:I.headerText,weight:"bold"},n),t&&a.createElement(p.c,{align:"center",color:"gray600",style:I.labelText},t),i,a.createElement(m.a,{onPress:r,size:"normalLarge",style:I.cancelButton,type:"text"},e))}}c()(O,"defaultProps",{cancelButtonLabel:E});const I=b.a.create(e=>({container:{alignItems:"center",paddingVertical:e.spaces.large,paddingHorizontal:e.spaces.xSmall,position:"relative"},headerText:{marginBottom:e.spaces.small},labelText:{marginBottom:e.spaces.small,width:"100%"},linkInput:{backgroundColor:e.colors.gray0,borderColor:"transparent",color:e.colors.gray600,fontSize:e.fontSizes.normal,marginBottom:e.spaces.xSmall,paddingVertical:e.spaces.xSmall,paddingHorizontal:e.spaces.medium},cancelButton:{width:"100%"}}));var f=O,g=n("I/9y"),h=n("mjJ+"),y=n("cm6r"),v=n("CaKu"),A=n("U+bB");const S=l.a.e05c00b4,T=l.a.eabf2209,j=l.a.a613e72f,C=l.a.f88553c8,R={riffsy:"https://abs.twimg.com/a/1501527574/img/t1/icon_riffsy.png",giphy:"https://abs.twimg.com/a/1501527574/img/t1/icon_giphy.png"};class D extends a.PureComponent{constructor(e){super(e),c()(this,"_renderMenu",e=>a.createElement(h.a,{items:[{text:j,Icon:g.a,onClick:this._handleCopyGifLinkButtonClick}],onCloseRequested:e})),c()(this,"_handleCopyGifLinkButtonClick",e=>{const{addToast:t,gifUrl:n}=this.props;v.a.isAvailable()?(v.a.setString(n),t({text:C})):this.setState({showCopyLinkSheet:!0}),e&&e()}),c()(this,"_handleCopyLinkSheetCancel",()=>{this.setState({showCopyLinkSheet:!1})}),this.state={showCopyLinkSheet:!1}}render(){const{showCopyLinkSheet:e}=this.state,{provider:t,gifUrl:n}=this.props,{display_name:s,name:r}=t,i=R[r];return i?a.createElement(a.Fragment,null,e?a.createElement(f,{description:T({providerName:s}),headerText:S,link:n,onCancel:this._handleCopyLinkSheetCancel}):null,a.createElement(p.c,{align:"center",color:"gray600",style:N.root},a.createElement(l.a.I18NFormatMessage,{$i18n:"e2e6ea0d"},this._renderAttribution(s,i)))):null}_renderAttribution(e,t){return a.createElement(y.a,{interactiveStyles:null,renderMenu:this._renderMenu},a.createElement(p.c,{weight:"bold",withInteractiveStyling:!0},a.createElement(A.a,{source:{uri:t},style:N.image}),a.createElement(p.c,{color:"normal"},e.toUpperCase())))}}const N=b.a.create(e=>({button:{marginLeft:e.spaces.xSmall},image:{display:"inline-block",height:e.spaces.small,marginHorizontal:e.spaces.xxSmall,width:e.spaces.small},root:{marginHorizontal:e.spaces.xSmall}}));var M=D;const x=i(({addToast:e,provider:t,gifUrl:n})=>a.createElement(M,{addToast:e,gifUrl:n,provider:t}));t.a=x},gpVt:function(e,t,n){"use strict";n.d(t,"b",(function(){return C}));var a=n("KEM+"),s=n.n(a),r=n("ERkP"),i=n("v6aA"),o=(n("wFPu"),n("kYxP"),n("ge3j")),c=n("VnFT"),d=n("vjRr"),u=n("rxPX"),l=n("0KEI");const _=(e,t)=>{const{urls:n}=t,a=[...n];let s;for(const t of a.reverse())if(s=d.a.select(e,t),s)break;return s};var p=Object(u.a)().propsFromState(()=>({card:_})).propsFromActions(()=>({createLocalApiErrorHandler:Object(l.d)("COMPOSER_CARD_PREVIEW"),fetchCardPreviewIfNeeded:d.a.fetchCardPreviewIfNeeded,updateDMComposer:c.e,updateTweetComposer:o.w})),m=n("KqB4"),b=n.n(m),E=n("NnR4"),O=n("3XMw"),I=n.n(O),f=n("hOZg"),g=n("cnVF"),h=n("MWbm"),y=n("/yvb"),v=n("rHpw"),A=n("VY6S"),S=n("mN6z");const T=I.a.f6fec9f6,j=/^https?:\/\//i,C=e=>{const t=b()(e);if(t.length)return t.map(e=>!j.test(e)&&"http://"+e||e)};class R extends r.Component{constructor(e,t){super(e,t),s()(this,"_fetchCardPreviewIfNeeded",()=>{const{fetchCardPreviewIfNeeded:e,urls:t,createLocalApiErrorHandler:n}=this.props;t.forEach(t=>{e(t).catch(n())})}),s()(this,"_handleCardPreviewDismissal",e=>this._updateSingleComposer({cardUrl:g.v})),s()(this,"_updateSingleComposer",e=>{const{conversationId:t,index:n,updateDMComposer:a,updateTweetComposer:s}=this.props,{cardUrl:r}=e||{};this._isDMComposer?t&&a(t,r):s({updates:{cardUrl:r},index:n})}),this._debouncedFetchCardPreview=Object(A.a)(this._fetchCardPreviewIfNeeded,1e3),this._isDMComposer=!!e.conversationId}componentDidMount(){this._debouncedFetchCardPreview()}componentDidUpdate(e){const{urls:t}=this.props;Object(S.a)(e.urls,t)||this._debouncedFetchCardPreview()}componentWillUnmount(){this._updateSingleComposer()}render(){const{card:e,isCardPreviewTombstoned:t,style:n}=this.props,{loggedInUserId:a}=this.context;return e&&!t?r.createElement(h.a,{style:n},r.createElement(E.a,{card:{name:e.name,url:e.url,binding_values:e.binding_values},cardContext:{tweetUserId:a},isInteractive:!1}),r.createElement(y.a,{accessibilityLabel:T,icon:r.createElement(f.a,null),onPress:this._handleCardPreviewDismissal,size:"small",style:D.closeButton,type:"onMedia"})):null}}s()(R,"contextType",i.a);const D=v.a.create(e=>({closeButton:{position:"absolute",top:e.spaces.xxSmall,left:e.spaces.xxSmall}})),N=p(R);t.a=N},jtO7:function(e,t,n){"use strict";var a=n("97Jx"),s=n.n(a),r=n("LdEA"),i=n.n(r),o=n("ERkP"),c=n("t62R"),d=n("I4+6"),u=n("cm6r"),l=n("rHpw"),_=n("MWbm");const p=l.a.create(e=>({container:{backgroundColor:e.colors.cellBackground},root:{justifyContent:"center",minHeight:e.spaces.xxLarge,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.small},bottomBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:1}}));t.a=e=>{let{align:t="center",color:n,label:a,withBottomBorder:r=!0}=e,m=i()(e,["align","color","label","withBottomBorder"]);const b=d.a.generate({backgroundColor:l.a.theme.colors.transparent,color:l.a.theme.colors[n],insetFocusRing:!0}),E=[p.root,r&&p.bottomBorder];return o.createElement(_.a,{style:p.container},o.createElement(u.a,s()({},m,{interactiveStyles:b,style:E}),o.createElement(c.c,{align:t,color:n},a)))}},kIAd:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var a=n("0vv5");const s=500,r={scoper:[{type:"dmUserSearch",regexp:/^[@＠]?(.*)|^$/,srcInputs:["compose_message"],scope:{result_type:"users",count:20}},{type:"username",regexp:/^[@＠](\w{1,20})/,srcInputs:["compose"],scope:{result_type:"users",count:20}},{type:"hashtag",regexp:n.n(a).a,srcInputs:["compose"],scope:{result_type:"topics",count:20}},{type:"topic",regexp:/(.+)/,srcInputs:["search_box"],scope:{result_type:"all"}},{type:"ttt",regexp:/(.+)/,srcInputs:["welcome_flow"],scope:{count:10,result_type:"topics,ttt"}}],WordBoundary:/[!'%&'()*+,\\\-./:;<=>?[\]^{|}~\s]|$/,WordEnd:/[^!'%&'()*+,\\\-./:;<=>?[\]^{|}~\s]+$/}},krmn:function(e,t,n){"use strict";n("kYxP");var a=n("ERkP"),s=(n("JtPf"),n("zb92")),r=n("RuTB"),i=n("3XMw"),o=n.n(i),c=Object(s.a)({loader:()=>o.a.emoji.then(()=>Promise.all([n.e(17),n.e(13),n.e(165)]).then(n.bind(null,"5RdJ"))),renderPlaceholder:(e,t)=>a.createElement(r.a,{hasError:e,onRetry:t})}),d=n.p+"twemoji_sprite.0fcc5555.png",u=n.p+"twemoji_sprite_high_res.f7008935.png",l=n("rHpw"),_=n("U+bB"),p=n("kLqS"),m=n("MWbm");const b=l.a.create(e=>({content:{backgroundColor:e.colors.cellBackground},dimensions:{height:"400px",borderRadius:e.borderRadii.xLarge,minWidth:`calc(${e.spaces.large} * 9 + 2 * ${e.spaces.xSmall})`},hidden:{display:"none"}}));var E=e=>{const{partialRender:t,onSelect:n}=e,s=p.a.get()>1?u:d;return a.createElement(a.Fragment,null,a.createElement(m.a,{style:[b.content,b.dimensions]},a.createElement(c,{onSelect:n,partialRender:t,rowSize:9,spriteUrl:s})),a.createElement(_.a,{source:s,style:b.hidden}))},O=n("pNJr"),I=n("2ZFc"),f=n("OiMc"),g=n("/yvb");const h=o.a.d4a4842d,y=a.createElement(O.a,null),v=e=>{const{disabled:t,onEmojiSelect:n,onPress:s,size:r,style:i,textInputRef:o}=e,[d,u]=a.useState(!0);a.useEffect(()=>{setTimeout(()=>{c.preload(),I.a.get("emojiPicker2")},5e3)},[]);return a.createElement(f.a,{enableEnterKeyToggle:!0,onAnimateComplete:()=>u(!1),onDismiss:()=>u(!0),onHoverCardUnmount:()=>{window.requestAnimationFrame(()=>o&&o.focus())},renderContent:()=>a.createElement(E,{onSelect:n,partialRender:d}),withArrow:!0},a.createElement(g.a,{accessibilityLabel:h,"aria-haspopup":"true",disabled:t,icon:y,onPress:e=>s&&s(e),size:r,style:i,type:"text"}))};v.defaultProps={disabled:!1,size:"small"};t.a=v},lRnM:function(e,t,n){"use strict";n.d(t,"f",(function(){return k})),n.d(t,"u",(function(){return F})),n.d(t,"y",(function(){return G})),n.d(t,"z",(function(){return q})),n.d(t,"C",(function(){return K})),n.d(t,"D",(function(){return z})),n.d(t,"B",(function(){return W})),n.d(t,"A",(function(){return Q})),n.d(t,"v",(function(){return Y})),n.d(t,"w",(function(){return X})),n.d(t,"x",(function(){return J})),n.d(t,"d",(function(){return Z})),n.d(t,"k",(function(){return $})),n.d(t,"l",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"m",(function(){return ne})),n.d(t,"a",(function(){return ae})),n.d(t,"r",(function(){return se})),n.d(t,"G",(function(){return re})),n.d(t,"o",(function(){return oe})),n.d(t,"c",(function(){return de})),n.d(t,"p",(function(){return le})),n.d(t,"q",(function(){return _e})),n.d(t,"L",(function(){return pe})),n.d(t,"t",(function(){return be})),n.d(t,"F",(function(){return Oe})),n.d(t,"h",(function(){return Ie})),n.d(t,"j",(function(){return fe})),n.d(t,"g",(function(){return ge})),n.d(t,"i",(function(){return he})),n.d(t,"M",(function(){return ye})),n.d(t,"J",(function(){return ve})),n.d(t,"K",(function(){return Ae})),n.d(t,"I",(function(){return Te})),n.d(t,"b",(function(){return Ce})),n.d(t,"s",(function(){return De})),n.d(t,"H",(function(){return Me})),n.d(t,"E",(function(){return xe})),n.d(t,"e",(function(){return Pe}));n("jQ/y"),n("IAdD"),n("JtPf"),n("kYxP");var a=n("LdEA"),s=n.n(a),r=n("oEOe"),i=n("AspN"),o=n("RqPI"),c=n("AQ79"),d=n("/kEJ"),u=n("xPna"),l=n("pXBW"),_=n("hqKg"),p=n("k49u"),m=n("/NU0"),b=n("aWyx"),E=n("WVrH"),O=n("G6rE"),I=n("uKEd"),f=n("k6jb"),g=n("kGix"),h=n("t0aI");function y(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const v=r.a(c.b,"ACCEPT_CONVERSATION"),A=r.a(c.b,"MUTE_DM_USER"),S=r.a(c.b,"ADD_PARTICIPANTS"),T=r.a(c.b,"FETCH_CONVERSATION"),j=r.a(c.b,"FETCH_CONVERSATION_FROM_PARTICIPANTS"),C=r.a(c.b,"LEAVE_CONVERSATION"),R=r.a(c.b,"MARK_CONVERSATION_READ"),D=r.a(c.b,"DISABLE_MENTION_CONVERSATION_NOTIFICATIONS"),N=r.a(c.b,"DISABLE_CONVERSATION_NOTIFICATIONS"),M=r.a(c.b,"ENABLE_MENTION_CONVERSATION_NOTIFICATIONS"),x=r.a(c.b,"ENABLE_CONVERSATION_NOTIFICATIONS"),P=r.a(c.b,"UPDATE_CONVERSATION_NAME"),w=r.a(c.b,"UPLOAD_MEDIA"),U=r.a(c.b,"UPDATE_GROUP_AVATAR"),L=(e,t)=>t+36e5*e,V={};function k(e=V,t){switch(t.type){case v.SUCCESS:{const{conversationId:n}=t.meta,a=e[n];return Object.assign({},e,{[n]:Object.assign({},a,{data:Object.assign({},a.data,{trusted:!0})})})}case ce:{const n=Object.entries(t.payload||{}).reduce((t,[n,a])=>(t[n]=Object.assign({},B(e[n],a),{fetchStatus:{[f.a]:g.a.LOADED,[f.b]:g.a.LOADED}}),t),{});return Object.assign({},e,n)}case S.REQUEST:{const n=t.meta.conversationId,a=e[n];return Object.assign({},e,{[n]:Object.assign({},a,{fetchStatus:Object.assign({},a.fetchStatus,{[f.b]:g.a.LOADING})})})}case S.FAILURE:{const n=t.meta.conversationId,a=e[n];return Object.assign({},e,{[n]:Object.assign({},a,{fetchStatus:Object.assign({},a.fetchStatus,{[f.b]:g.a.FAILED})})})}case S.SUCCESS:{const n=t.meta.conversationId,a=e[n],s=a.data.participants,r=t.payload.entities.entries?Object.values(t.payload.entities.entries)[0].participants:[];return Object.assign({},e,{[n]:Object.assign({},a,{fetchStatus:Object.assign({},a.fetchStatus,{[f.b]:g.a.LOADED}),data:Object.assign({},a.data,{participants:[...s,...r]})})})}case T.REQUEST:{const{conversationId:n,direction:a=f.a}=t.meta,s=e[n];return Object.assign({},e,{[n]:Object.assign({},s,{fetchStatus:Object.assign({},s&&s.fetchStatus||{},{[a]:g.a.LOADING})})})}case T.FAILURE:{const{conversationId:n,direction:a=f.a}=t.meta,s=e[n];return Object.assign({},e,{[n]:Object.assign({},s,{fetchStatus:Object.assign({},s&&s.fetchStatus||{},{[a]:g.a.FAILED}),error:t.payload})})}case T.SUCCESS:{const{conversationId:n,direction:a=f.a}=t.meta;return Object.assign({},e,{[n]:Object.assign({},e[n],{fetchStatus:Object.assign({},e[n]&&e[n].fetchStatus||{},{[a]:g.a.LOADED})})})}case ue:return Object.entries(e).reduce((n,[a,s])=>(n[a]=B(e[a],{last_read_event_id:t.payload}),n),{});case R.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{last_read_event_id:t.meta.lastReadEventId})});case A.SUCCESS:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{muted:t.meta.mute})});case me:{const n=t.payload;return s()(e,[n].map(y))}case C.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:Object.assign({},e[t.meta.conversationId],{isDeleted:!0})});case Ee:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{notifications_disabled:!t.payload})});case N.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{notifications_disabled:!0,mute_expiration_time:(n=(new Date).getTime(),[void 0,L(1,n),L(8,n),L(168,n)])[t.meta.duration]})});case D.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{mention_notifications_disabled:!0})});case x.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{notifications_disabled:!1})});case M.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{mention_notifications_disabled:!1})});case Ne:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{avatar_image_https:t.payload})});case P.REQUEST:case P.SUCCESS:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{name:t.meta.name})});case Se:{const n=e[t.meta.conversationId],a=n&&n.data&&n.data.max_entry_id||"0";return Object(h.b)(t.payload,a)?Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{max_entry_id:t.payload})}):e}case w.REQUEST:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{isUploading:!0})});case w.FAILURE:case w.SUCCESS:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{isUploading:!1})});case je:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{avatarMediaId:t.payload})});case Re:return Object.assign({},e,{[t.meta.conversationId]:B(e[t.meta.conversationId],{avatarMediaId:null})});case E.a:return V;default:return e}var n}const B=(e={},t={},n=[])=>{const a=s()(e,["error"]),{avatarMediaId:r=null}=Object(m.a)(t.avatarMediaId)?t:a,{isUploading:i=!1}=t,{max_entry_id:o}=t,c=s()(t,["avatarMediaId","isUploading","max_entry_id"]),d=Object.assign({},a&&a.data,c);var u,l;return!!c.conversation_id&&!c.convo_label&&delete d.convo_label,o&&(d.max_entry_id=(u=o,l=a&&a.data&&a.data.max_entry_id,Object(h.c)(u,l)?u:l)),Object.assign({},a,{avatarMediaId:r,data:d,isUploading:i})},F=(e,t)=>e[c.a].conversations[t],G=(e,t)=>{const n=F(e,t);return n?Object(g.b)(n.fetchStatus,n.data):g.a.LOADED},q=(e,t)=>{const n=F(e,t);return!!n&&Object(g.b)(n.fetchStatus,n.data)===g.a.LOADED},H=(e,t)=>{const n=F(e,t);return!!n&&n.fetchStatus[f.a]===g.a.LOADING},K=Object(_.createSelector)(e=>e[c.a].conversations,e=>Object.entries(e).reduce((e,[t,n])=>(n.data&&!n.isDeleted&&(e[t]=n),e),{})),z=e=>Object.keys(K(e)).length>0,W=(e,t)=>{const{data:n}=F(e,t)||{},{sort_event_id:a}=n||{};if(a){const t=o.h(e),{message_data:n,by_user_id:s,id:r,sender_id:i}=Object(I.n)(e,a)||{};if(i&&i!==t||n&&n.sender_id!==t||s&&s!==t)return r}return null},Q=(e,t)=>{const n=W(e,t),{data:a}=F(e,t)||{};return!n||!!(a&&a.last_read_event_id&&Object(h.c)(a.last_read_event_id,n))},Y=(e,t)=>{const{avatarMediaId:n}=F(e,t)||{};return n},X=(e,t)=>{const{isUploading:n}=F(e,t)||{};return n},J=(e,t)=>i.h(e,Y(e,t)),Z=(e,t)=>(n,a,{api:s})=>{const i=t.join(",");return r.b(n,{params:{conversationId:e,joinedParticipantIds:i},request:s.DirectMessages.addParticipants})({actionTypes:S,context:"ACTION_DM_ADD_PARTICIPANTS",meta:{conversationId:e,participantIds:t}},e=>{if(e){const{entities:t}=e;return[t.entries&&Object(I.a)(t.entries),Object(d.c)(t)]}}).then(e=>{const t=e.result.failed_participants;if(!t)return Promise.resolve(e);const n=Object.keys(t),a=1===n.length?t[n[0]]:p.a.DefaultApiError,s=new l.a("addParticpants URL",500,e.headers,[{code:a}]);return s.context.action="ACTION_DM_ADD_PARTICIPANTS",Promise.reject(s)})},$=(e={})=>(t,n,{api:a})=>{const{conversationId:s,context:i}=e;return r.b(t,{params:e,request:a.DirectMessages.fetchConversation})({actionTypes:T,context:i,meta:{conversationId:s,direction:Object(f.c)(e)}},e=>{if(e){const{cards:t,entries:n,tweets:a,users:s}=e.entities,{conversations:r,max_entry_id:i,min_entry_id:o,status:c}=e.result.conversation_timeline,d=((e={},t)=>Object.entries(e).reduce((e,[n,a])=>Object.assign({},e,{[n]:Object.assign({},a,t)}),{}))(r,{max_entry_id:i,min_entry_id:o,status:c});return Object(u.c)({conversations:d,entries:n,users:s,tweets:a,cards:t})}})},ee=e=>(t,n,{api:a})=>r.b(t,{params:{participantIds:e},request:a.DirectMessages.fetchConversationFromParticipants})({actionTypes:j,meta:{participantIds:e}}),te=(e={})=>(t,n)=>{const a=n(),{conversationId:s}=e,{data:r={}}=F(a,s)||{},i=H(a,s);return(!r.status||r.status===b.c.HAS_MORE)&&!i?t($({conversationId:s,context:"FETCH_DM_CONVERSATION"})):Promise.resolve()},ne=(e={})=>(t,n)=>{const a=n(),{conversationId:s}=e,{data:r}=F(a,s)||{},{status:i,min_entry_id:o}=r||{},c=H(a,s);return i!==b.c.HAS_MORE||c?Promise.resolve():t($(Object.assign({},e,{max_id:o,context:"FETCH_DM_CONVERSATION_HISTORY"})))},ae=e=>(t,n,{api:a})=>r.b(t,{params:{conversationId:e},request:a.DirectMessages.acceptConversation})({actionTypes:v,meta:{conversationId:e}}),se=(e,t)=>ie(e,t,!0),re=(e,t)=>ie(e,t,!1),ie=(e,t,n)=>(a,s,{api:i})=>r.b(a,{params:{userId:e,relationshipAction:n?"mute":"unmute",conversationId:t},request:i.DirectMessages.muteDMUser})({actionTypes:A,meta:{userId:e,conversationId:t,mute:n}}).then(a(O.e.patchUser(e,{dm_muting:n}))),oe=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e;return r.c(t,{params:e,request:a.DirectMessages.leaveConversation})({actionTypes:C,context:"ACTION_LEAVE_CONVERSATION",meta:{conversationId:s}})},ce=c.c("ADD_CONVERSATIONS"),de=e=>({payload:e,type:ce}),ue=c.c("MARK_ALL_AS_READ"),le=e=>({payload:e,type:ue}),_e=(e,t)=>({type:R.REQUEST,meta:{conversationId:e,lastReadEventId:t}}),pe=e=>(t,n,{api:a})=>{const s=n(),{data:i={}}=F(s,e)||{},{sort_event_id:o}=i,c=!Q(s,e);if(e&&o&&c){return r.c(t,{params:{conversationId:e,last_read_event_id:o},request:a.DirectMessages.markRead})({actionTypes:R,bypassFailureOnErrors:()=>!0,context:"APP_DM_UPDATE_CONVERSATION_READ_STATE",meta:{conversationId:e,lastReadEventId:o}})}return Promise.resolve()},me=c.c("REMOVE_CONVERSATION"),be=e=>[{payload:e,type:me},Object(I.i)(e)],Ee=c.c("TOGGLE_CONVERSATION_NOTIFICATIONS"),Oe=(e,t)=>({meta:{conversationId:e},payload:t,type:Ee}),Ie=(e={})=>(t,n,{api:a})=>{const{conversationId:s,duration:i}=e;return r.c(t,{params:e,request:a.DirectMessages.disableNotifications})({actionTypes:N,context:"ACTION_DISABLE_NOTIFICATIONS",meta:{conversationId:s,duration:i}})},fe=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e;return r.c(t,{params:e,request:a.DirectMessages.enableNotifications})({actionTypes:x,context:"ACTION_ENABLE_NOTIFICATIONS",meta:{conversationId:s}})},ge=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e,i=Object.assign({mention_notifications_disabled:!0},e);return r.c(t,{params:i,request:a.DirectMessages.updateMentionNotificationsSetting})({actionTypes:D,context:"ACTION_DISABLE_DM_MENTION_NOTIFICATIONS",meta:{conversationId:s}})},he=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e,i=Object.assign({mention_notifications_disabled:!1},e);return r.c(t,{params:i,request:a.DirectMessages.updateMentionNotificationsSetting})({actionTypes:M,context:"ACTION_ENABLE_DM_MENTION_NOTIFICATIONS",meta:{conversationId:s}})},ye=(e={})=>(t,n,{api:a})=>a.DirectMessages.updateTyping(e),ve=(e={})=>(t,n,{api:a})=>{const{conversationId:s,name:i}=e;return r.c(t,{params:e,request:a.DirectMessages.updateConversationName})({actionTypes:P,context:"ACTION_UPDATE_CONVERSATION_NAME",meta:{conversationId:s,name:i}})},Ae=e=>({type:P.SUCCESS,meta:{conversationId:e.conversation_id,name:e.conversation_name}}),Se=c.c("UPDATE_CONVERSATION_MAX_ENTRY_ID"),Te=(e,t)=>({meta:{conversationId:e},payload:t,type:Se}),je=c.c("ADD_AVATAR_MEDIA"),Ce=(e,t)=>({meta:{conversationId:e},payload:t,type:je}),Re=c.c("REMOVE_AVATAR_MEDIA"),De=(e,t)=>({meta:{conversationId:e},payload:t,type:Re}),Ne=c.c("UPDATE_CONVERSATION_AVATAR"),Me=(e,t)=>({meta:{conversationId:e},payload:t,type:Ne}),xe=e=>(t,n,{api:a})=>{t({meta:{conversationId:e},type:w.REQUEST});const s=Y(n(),e),o=i.k(s);return t(o).then(([n])=>{t({meta:{conversationId:e},type:w.SUCCESS});return r.b(t,{params:{conversationId:e,avatar_id:n.uploadId},request:a.DirectMessages.updateConversationAvatar})({actionTypes:U,context:"APP_DM_UPDATE_CONVERSATION_AVATAR"})},n=>{const a={errors:n,context:"APP_DM_UPDATE_CONVERSATION_AVATAR"};return t({meta:{conversationId:e},type:w.FAILURE}),Promise.reject(a)})},Pe=(e,t)=>(n,a,{api:s})=>r.d(n,{params:{conversation_id:e,welcome_message_id:t},request:s.DirectMessages.addWelcomeMessageToConversation})("ADD_WELCOME_MESSAGE_TO_CONVERSATION")},mtvn:function(e,t,n){"use strict";t.a=(e,t,n=1)=>{const a=[];for(let s=e;n>0?s<t:s>t;s+=n)a.push(s);return a}},oEoC:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return c}));n("IAdD"),n("WNMA"),n("LJOr"),n("tVqn"),n("kYxP");var a=n("kIAd");function s(e,t){let n;const s=a.b.scoper.find(a=>{if(-1!==a.srcInputs.indexOf(t))return n=e.match(a.regexp),n});let r="";return n&&(r=n&&(1===n.length?n[0]:n[1])),s?Object.assign({},s.scope,{src:t,q:r}):null}function r(e,t){const n=t.slice(0,e),s=t.slice(e,t.length),r=n.search(a.b.WordEnd),i=r>=0?n.slice(r):"",o=s.search(a.b.WordBoundary),c=i+s.slice(0,o);return c.trim()?{start:r,end:e+o,word:c}:{start:-1,end:-1,word:""}}function i(){return"typeaheadFocus-"+Math.random()}function o(e){const{altKey:t,ctrlKey:n,metaKey:a}=e;return!(t||n||a)}function c(e,t){const n=[];e.forEach(e=>{const a=t.find(t=>t.id===e.id);a&&a.data&&a.data.result_context?n.push(a):n.push(e)});const a=n.map(e=>e.id),s=t.filter(e=>a.indexOf(e.id)<0);return[...n,...s]}},pKoL:function(e,t,n){"use strict";n("kYxP");var a=n("KEM+"),s=n.n(a),r=n("ERkP"),i=n("HPNB"),o=n("9HgX"),c=n("3XMw"),d=n.n(c),u=n("LCtV"),l=(n("IAdD"),n("LdEA")),_=n.n(l),p=n("k/Ka"),m=n("eXeu"),b=n("iOGT");class E extends r.Component{constructor(...e){super(...e),s()(this,"_setVideoRef",e=>{const{getVideoRef:t}=this.props;t&&t(e)})}render(){const e=this.props,{children:t,dataSaverMode:n,style:a,variants:s}=e,i=_()(e,["children","dataSaverMode","getVideoRef","style","variants"]),o=Object(b.b)(s,n?b.a.MEDIUM:b.a.HIGH)||[],c=Object(m.e)(o.map(e=>({src:e.url,type:e.content_type})));return Object(p.a)("video",Object.assign({},i,{children:[c.map(e=>r.createElement("source",{key:e.src,src:e.src,type:e.type})),t],ref:this._setVideoRef,style:a}))}}s()(E,"defaultProps",{dataSaverMode:!1,variants:[]});var O=n("sjK1"),I=n("cHvH"),f=n("mXq/"),g=n("/yvb"),h=n("a6qo"),y=n("rHpw"),v=n("hOZg"),A=n("tuke"),S=n("U+bB"),T=n("MWbm"),j=n("+/sI");const C=d.a.gd80afba,R=d.a.abd845fd,D=d.a.df1b0707,N=d.a.cd959e5b,M=d.a.add55c97;class x extends r.Component{constructor(...e){super(...e),s()(this,"state",{isVideoPaused:!0,playGif:!1}),s()(this,"_handleGifClick",()=>{this.setState({playGif:!this.state.playGif})}),s()(this,"_handleMediaPreviewLayout",e=>{const{mediaItem:t,resizeIfNeeded:n}=this.props,a=t.mediaFile||t.externalMediaDetails;if(!a)return;const{nativeEvent:{layout:{height:s,width:r}}}=e,{height:i,width:o}=a,c=o/i;Math.abs(c-r/s)>.05&&this._mediaContainer&&("width"===n?this._mediaContainer.setNativeProps({style:{width:s*c}}):"height"===n&&this._mediaContainer.setNativeProps({style:{height:r/c}}))}),s()(this,"_handleVideoOnPlay",e=>{this.setState({isVideoPaused:!1})}),s()(this,"_handleVideoOnPause",e=>{this.setState({isVideoPaused:!0})}),s()(this,"_setMediaContainerRef",e=>{this._mediaContainer=e}),s()(this,"_setVideoRef",e=>{this._video=e}),s()(this,"_playVideo",()=>{if(this._video){const e=this._video.play();void 0!==e&&e.then(e=>{this._handleVideoOnPlay()}).catch()}}),s()(this,"_pauseVideo",()=>{this._video&&(this._video.pause(),this._handleVideoOnPause())})}render(){const{accessibilityLabel:e,accessibilityRole:t,enableGif:n,mediaItem:a,onEdit:s,onRemove:c,style:d,withAltTextLabel:u,withCloseButton:l,withEditButton:_}=this.props,{playGif:p}=this.state,m=a.externalMediaDetails&&a.externalMediaDetails.mediaType===o.a,b=m||n&&a.mediaFile&&a.mediaFile.isGif;return r.createElement(I.a,null,({windowWidth:n})=>{const a=i.a.isTwoColumnLayout(n);return r.createElement(T.a,{accessibilityLabel:e||M,accessibilityRole:t,onLayout:this._handleMediaPreviewLayout,ref:this._setMediaContainerRef,style:[d,P.cursor,m&&P.gifPlayButton]},this._renderPreview(),m&&!p&&r.createElement(f.a,{accessibilityLabel:D,onPress:this._handleGifClick,size:"small"}),l?r.createElement(g.a,{accessibilityLabel:N,icon:r.createElement(v.a,null),onPress:c,size:"small",style:P.close,type:"onMedia"}):null,b?r.createElement(j.c,{type:j.a}):null,u?r.createElement(h.a,{align:"left",bold:!0},"ALT"):null,_?r.createElement(g.a,{accessibilityLabel:C,icon:a?void 0:r.createElement(A.a,null),onPress:s,size:a?"normalCompact":"small",style:P.edit,type:"onMedia"},a&&R):null)})}_renderPreview(){const{mediaItem:e}=this.props;if(e.externalMediaDetails){const t=e.externalMediaDetails.previewUrl,n=e.externalMediaDetails.stillMediaUrl;return this._renderGifPreview(t,n)}if(e.mediaFile&&e.mediaFile.isVideo){const t=[{content_type:e.mediaFile.type,url:e.mediaFile.url}];return this._renderVideoPreview(t)}return r.createElement(T.a,{style:y.a.absoluteFill},this._renderImagePreview())}_renderGifPreview(e,t){const{playGif:n}=this.state,a={uri:n?e:t};return r.createElement(T.a,{onClick:this._handleGifClick,style:y.a.absoluteFill},r.createElement(S.a,{resizeMode:"cover",source:a,style:P.video}))}_renderImagePreview(){const{borderRadius:e,enableGif:t,mediaItem:n,onClick:a}=this.props;return r.createElement(u.b,{borderRadius:e,enableGif:t,mediaItem:n,onClick:a})}_renderVideoPreview(e){const{mediaItem:{mediaFile:t}}=this.props;return r.createElement(E,{autoPlay:!1,controls:!0,getVideoRef:this._setVideoRef,loop:!0,muted:!0,onPause:this._handleVideoOnPause,onPlay:this._handleVideoOnPlay,playsInline:!0,poster:t instanceof O.c?t.thumbnail:"",style:P.video,variants:e})}}s()(x,"defaultProps",{enableGif:!0,withCloseButton:!0,withAltTextLabel:!1,withEditButton:!1});const P=y.a.create(e=>({close:{position:"absolute",left:e.spaces.xxSmall,top:e.spaces.xxSmall},cursor:{cursor:"pointer"},edit:{position:"absolute",right:e.spaces.xxSmall,top:e.spaces.xxSmall},gifPlayButton:{alignItems:"center",justifyContent:"center"},video:{height:"100%",width:"100%"}}));t.a=x},rFBM:function(e,t,n){"use strict";n("kYxP");var a=n("KEM+"),s=n.n(a),r=n("ERkP"),i=n("rHpw"),o=n("k/Ka"),c=n("MWbm");const d=e=>Object(o.a)("div",e);class u extends r.Component{constructor(...e){super(...e),s()(this,"_dragEnterCount",0),s()(this,"state",{active:!1}),s()(this,"_handleDragDrop",e=>{const{onFilesAdded:t}=this.props;e.preventDefault();t(Array.from(e&&e.dataTransfer.files)),this._updateDragCount(0)}),s()(this,"_handleDragEnter",e=>{const{onDragEnter:t}=this.props;e.preventDefault(),t&&t(),this._updateDragCount(this._dragEnterCount+1)}),s()(this,"_handleDragLeave",e=>{e.preventDefault(),this._updateDragCount(this._dragEnterCount-1)}),s()(this,"_handleDragOver",e=>{e.preventDefault()})}render(){const{allowDragDrop:e,children:t,style:n}=this.props,{active:a}=this.state,s=e?l.dragBorderValid:l.dragBorderInvalid;return r.createElement(d,{onDragEnter:this._handleDragEnter,onDragLeave:this._handleDragLeave,onDragOver:this._handleDragOver,onDrop:this._handleDragDrop,style:[l.root,n,a&&s]},r.createElement(c.a,{style:l.inner},"function"==typeof t?t(a):t))}_updateDragCount(e){this._dragEnterCount=e,0===this._dragEnterCount?this.setState({active:!1}):this._dragEnterCount>0&&this.setState({active:!0})}}s()(u,"defaultProps",{allowDragDrop:!0});const l=i.a.create(e=>({root:{display:"flex",flexDirection:"column"},dragBorderValid:{borderStyle:"dashed",borderWidth:e.spaces.micro,borderColor:e.colors.primary},dragBorderInvalid:{borderStyle:"dashed",borderWidth:e.spaces.micro,borderColor:e.colors.red500},inner:{flexGrow:1}}));t.a=u},tuke:function(e,t,n){"use strict";n("IAdD");var a=n("ERkP"),s=n("Lsrn"),r=n("k/Ka");const i=(e={})=>Object(r.a)("svg",Object.assign({},e,{style:[s.a.root,e.style],viewBox:"0 0 24 24"}),a.createElement("g",null,a.createElement("path",{d:"M21.592 5.576c.877-.967.882-2.298.006-3.174-.877-.877-2.208-.87-3.174.006 0 0-.003 0-.004.002l-.006.006-.005.004s-.002 0-.002.002L8.398 11.27c-1.716-.214-3.424.31-4.534 1.42-3.872 3.874-1.523 9.616-1.422 9.858.1.24.32.41.577.45.037.007.075.01.113.01.218 0 .428-.095.57-.265 1.83-2.15 3.043-2.023 4.328-1.89 1.164.122 2.477.258 3.834-1.282.975-1.106 1.302-2.585.922-4.03l8.792-9.948h.002l.004-.006.006-.006.002-.004zm-1.055-2.113c.305.305.28.74-.06 1.11-.003.003-.004.007-.006.01 0 0-.003 0-.004.003l-5.662 6.406-1.796-1.796 6.406-5.662c.002 0 .002-.003.004-.005.002-.003.006-.004.008-.006.37-.34.807-.365 1.11-.06zm-8.62 10.797L9.74 12.084l2.142-1.894 1.927 1.927-1.894 2.143zm-1.178 4.32c-.848.96-1.488.895-2.552.78-1.27-.13-2.808-.293-4.722 1.463-.415-1.673-.784-4.83 1.457-7.072.807-.805 2.086-1.168 3.377-.983l2.977 2.976c.333 1.03.15 2.057-.538 2.836z"})));i.metadata={width:24,height:24},t.a=i},uKEd:function(e,t,n){"use strict";n.d(t,"e",(function(){return A})),n.d(t,"a",(function(){return C})),n.d(t,"f",(function(){return R})),n.d(t,"d",(function(){return D})),n.d(t,"k",(function(){return N})),n.d(t,"i",(function(){return x})),n.d(t,"r",(function(){return P})),n.d(t,"h",(function(){return w})),n.d(t,"b",(function(){return L})),n.d(t,"j",(function(){return k})),n.d(t,"c",(function(){return F})),n.d(t,"g",(function(){return q})),n.d(t,"l",(function(){return H})),n.d(t,"n",(function(){return K})),n.d(t,"o",(function(){return z})),n.d(t,"m",(function(){return W})),n.d(t,"p",(function(){return Q})),n.d(t,"q",(function(){return Y}));n("IAdD"),n("DZ+c"),n("kYxP");var a=n("LdEA"),s=n.n(a),r=n("t0aI"),i=n("aWyx"),o=n("SrIh"),c=n("WVrH"),d=n("fEA7"),u=n.n(d),l=n("AQ79"),_=n("3A2y"),p=n("J4ZH"),m=n("4FGy"),b=n("s1N3"),E=n("lnti"),O=n("oEOe");const I=Object(O.a)(l.b,"DELETE_MESSAGE"),f=Object(O.a)(l.b,"REACTION_CREATE"),g=Object(O.a)(l.b,"REACTION_DELETE"),h=Object(O.a)(l.b,"MARK_ENTRIES_AS_SPAM"),y=Object(O.a)(l.b,"MARK_ENTRIES_AS_NOT_SPAM"),v={entries:{},entryIdsByConversationId:{},reactionsByMessageId:{}};function A(e=v,t){const{conversationId:n,requestId:a}=t.meta||{};switch(t.type){case U:{const{id:a}=t.payload,s=Object.assign({},e.entries,{[a]:S(e.entries[a],{data:t.payload})});return Object.assign({},e,{entries:s,entryIdsByConversationId:Object.assign({},e.entryIdsByConversationId,{[n]:T([...e.entryIdsByConversationId[n]||[],a],s)})})}case j:{const n=Object.values(t.payload).filter(e=>e.type!==i.b.CONVERSATION_READ).reduce((t,n)=>{const{id:a}=n,s=Object(_.a)(n,"message_reactions");return t.allEntries[a]=S(e.entries[a],{data:s,isLoading:!1,isLoaded:!0}),n.message_reactions&&(n.message_reactions.forEach(a=>{const s=Object.assign({},a,{affects_sort:!0,message_id:n.id,type:i.b.REACTION_CREATE});t.allEntries[s.id]=S(e.entries[s.id],{data:s,isLoading:!1,isLoaded:!0})}),t.embeddedReactionsByMessageId[a]=T([...e.reactionsByMessageId[a]||[],...n.message_reactions.map(e=>e.id)],Object.assign({},e.entries,t.allEntries))),t},{allEntries:{},embeddedReactionsByMessageId:{}}),a=Object.assign({},e.entries,n.allEntries),s=Object(p.a)(Object.values(n.allEntries),e=>e.data.conversation_id),r=Object.keys(s).reduce((t,n)=>{const r=s[n].map(e=>e.data.id);return t[n]=T([...e.entryIdsByConversationId[n]||[],...r],a),t},{});return Object.assign({},e,{entries:a,entryIdsByConversationId:Object.assign({},e.entryIdsByConversationId,r),reactionsByMessageId:Object.assign({},e.reactionsByMessageId,n.embeddedReactionsByMessageId)})}case h.REQUEST:case y.REQUEST:{const n=t.type===h.REQUEST,a=t.payload.reduce((t,a)=>{const s=e.entries[a]&&e.entries[a].data;return Object.assign({},t,{[a]:Object.assign({},e.entries[a],{data:Object.assign({},s,{marked_as_spam:n})})})},{});return Object.assign({},e,{entries:Object.assign({},e.entries,a)})}case I.REQUEST:case M:{const a=t.type===M&&!Array.isArray(t.payload),s=e.entryIdsByConversationId[n]||[],r=t.type===M?a?s:t.payload:[t.payload,...e.reactionsByMessageId[t.payload]||[]];return Object.assign({},e,{entries:Object(_.a)(e.entries,r),entryIdsByConversationId:Object.assign({},Object(_.a)(e.entryIdsByConversationId,n),a?{}:{[n]:Object(m.a)(s,r)}),reactionsByMessageId:Object(_.a)(e.reactionsByMessageId,r)})}case V:{const s=t.payload.id||a,r=Object.assign({},Object(_.a)(e.entries,s)),i=T((e.entryIdsByConversationId[n]||[]).filter(e=>e!==s),r),o=i?{[n]:i}:{};return Object.assign({},e,{entries:r,entryIdsByConversationId:Object.assign({},Object(_.a)(e.entryIdsByConversationId,n),o),reactionsByMessageId:Object(_.a)(e.reactionsByMessageId,s)})}case B:{const n=t.payload,a=[...e.reactionsByMessageId[n.message_id]||[],n.id],s=a.filter(t=>e.entries[t]);a.length!==s.length&&Object(o.a)("DM add reaction is missing a backing entry",{extra:{filteredMessageReactionIds:s,messageReactionIds:a,currentId:n.id}});const r=T(s,e.entries);return Object.assign({},e,{reactionsByMessageId:Object.assign({},e.reactionsByMessageId,{[n.message_id]:r})})}case g.REQUEST:case G:{const n=t.payload,a=(e.reactionsByMessageId[n.message_id]||[]).find(t=>e.entries[t].data.sender_id===n.sender_id);if(!a)return e;const s=Object(m.a)(e.entryIdsByConversationId[n.conversation_id],a),r=Object(m.a)(e.reactionsByMessageId[n.message_id],a);return Object.assign({},e,{entries:Object(_.a)(e.entries,a),entryIdsByConversationId:Object.assign({},e.entryIdsByConversationId,{[n.conversation_id]:s}),reactionsByMessageId:Object.assign({},e.reactionsByMessageId,{[n.message_id]:r})})}case c.a:return v;default:return e}}const S=(e,t)=>{const n=e||{},a=s()(n,["error","isLoaded","isLoading"]),r=t||{},{data:i}=r,o=s()(r,["data"]);return Object.assign({},a,{data:Object.assign({},a&&a.data,i)},o)},T=(e=[],t)=>{const n=Object(b.a)(e).sort((e,n)=>{const a=Object(r.a)(t[e].data.time,t[n].data.time);return 0===a?Object(r.a)(t[e].id,t[n].id):a});return n.length?n:void 0},j=Object(l.c)("ADD_ENTRIES"),C=e=>({payload:e,type:j}),R=e=>(t,n,{api:a})=>{const r=e||{},{id:i,conversationId:o,requestId:c=u.a.v1()}=r,d=s()(r,["id","conversationId","requestId"]),l=Object.assign({},d,{id:i,request_id:c});return Object(O.c)(t,{params:l,request:a.DirectMessages.deleteMessage})({actionTypes:I,context:"ACTION_DELETE_DM",payload:i,meta:{conversationId:o}})},D=e=>(t,n,{api:a})=>{const s=(({reaction_key:e,conversation_id:t,dm_id:n,perspective:a})=>({id:u.a.v1(),time:(new Date).getTime().toString(),reaction_key:e,conversation_id:t,message_id:n,sender_id:a,type:i.b.REACTION_CREATE}))(e);t([L(s.conversation_id,s.id,s),q(s),F(s)]);return Object(O.b)(t,{params:Object(_.a)(e,"perspective"),request:a.DirectMessages.addReaction})({actionTypes:f,context:"ACTION_REACTION_CREATE"},(e,t)=>{if(t)return[q(s)]})},N=e=>(t,n,{api:a})=>{const{perspective:r}=e,i=s()(e,["perspective"]);return Object(O.c)(t,{params:i,request:a.DirectMessages.deleteReaction})({actionTypes:g,context:"ACTION_REACTION_DELETE",payload:{conversation_id:e.conversation_id,message_id:e.dm_id,sender_id:r}})},M="rweb/dm/REMOVE_CONVERSATION_ENTRIES",x=(e,t)=>({meta:{conversationId:e},payload:t,type:M}),P=(e,t)=>({payload:e,type:t?h.REQUEST:y.REQUEST}),w=({conversationId:e,dmId:t,markSpam:n})=>(a,s,{api:r})=>Object(O.c)(a,{params:{dm_id:t,report_as:n?"spam":"not_spam"},request:r.DirectMessages.reportSpam})({actionTypes:n?I:y,payload:n?t:[t],meta:{conversationId:e}}),U=Object(l.c)("ADD_ENTRY"),L=(e,t,n)=>({meta:{conversationId:e,requestId:t},payload:n,type:U}),V=Object(l.c)("REMOVE_ENTRY"),k=(e,t,n)=>({meta:{conversationId:e,requestId:t},payload:n,type:V}),B=Object(l.c)("ADD_REACTION"),F=e=>({payload:e,type:B}),G=Object(l.c)("DELETE_REACTION"),q=e=>({payload:e,type:G}),H=e=>e[l.a].entries,K=(e,t)=>{const n=H(e).entries[t];return n&&n.data},z=(e,t)=>e[l.a].entries.entryIdsByConversationId[t],W=(e,t)=>{const n=z(e,t);return n?Object(E.a)(n.map(t=>K(e,t))):[]},Q=(e,t)=>H(e).reactionsByMessageId[t],Y=(e,t)=>(Q(e,t)||[]).map(t=>K(e,t).sender_id)},ude7:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n("JtPf");var a=n("A0bJ"),s=n("hJBK"),r=n("1auM");const i=1,o=2,c=3,d=e=>{if(Object(r.b)(e)){if(e.isGif){const{img:t,width:n,height:r,orientation:i}=e;return Object(s.b)(t,n,r,i).then(e=>Object(s.a)(e),e=>{throw new a.a("Gif preview could not be generated",c)})}{const e=new a.a("The provided image must be a gif",o);return Promise.reject(e)}}{const e=new a.a("The provided file is not a valid image",i);return Promise.reject(e)}}},w3n3:function(e,t,n){"use strict";var a=n("ERkP"),s=n("/yvb"),r=(n("MLl7"),n("3XMw")),i=n.n(r),o=n("3rWK"),c=n("Irs7");const d=i.a.a4993fa1,u=a.createElement(o.a,null);t.a=({dmConversationId:e,enabled:t=!0,gifSearchKeySource:n,history:r,style:i,onPress:o})=>{const l=Object(c.b)(),_=a.useCallback(()=>{o&&o(),l.scribe({element:"found_media_button",action:"click"}),r.push({pathname:"/i/foundmedia/search",state:{gifSearchKeySource:n,dmConversationId:e}})},[e,l,n,r,o]);return a.createElement(s.a,{accessibilityLabel:d,disabled:!t,icon:u,onPress:_,size:"normal",style:[i],type:"text"})}},wpu3:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));n("kYxP");var a=n("1auM"),s=(n("S1qy"),n("VAyw")),r=n("/Ikv"),i=n("s1N3"),o=n("lnti");const c=({inReplyToStatus:e,loggedInUserId:t,excludeReplyUser:n})=>{const{retweeted_status:a}=e,{entities:r}=a||e,{user:c}=e.retweeted_status||e,u=a?a.user:{},l=a?e.user:{},_=r.user_mentions||[],p=s.a.mergeTaggedUsers(r.media||[]),m=d(a||e)||{},b={[u.id_str]:u,[l.id_str]:l,[c.id_str]:c,[m.id_str]:m};_.forEach(e=>{b[e.id_str]=e}),p.forEach(({user_id:e,name:t,screen_name:n})=>{b[e]={id_str:e,name:t,screen_name:n}});const E=Object(i.a)(Object(o.a)([u.id_str,l.id_str,c.id_str,..._.map(e=>e.id_str),...p.map(e=>e.user_id)])).filter(e=>e!==t);let O=t&&c.id_str===t?[t,...E]:E;return n&&(O=O.filter(e=>e!==c.id_str)),O.map(e=>b[e])},d=({card:e})=>{let t=null;if(e){const n=r.a.getBindingValue(e.binding_values,"site");n&&e.users&&(t=e.users[n.id_str])}return t},u=({maxNumberOfPhotos:e})=>t=>{if(0===t.length)return!0;const n=t.some(e=>!!e.externalMediaDetails),s=!n&&t.some(e=>e.mediaFile&&e.mediaFile.isGif),r=t.some(e=>e.mediaFile&&!(e.mediaFile instanceof a.a)&&e.mediaFile.isVideo);if(s||n||r)return 1===t.length;{const n=t.length<=e,a=t.every(e=>e.mediaFile&&e.mediaFile.isImage);return n&&a}},l=u({maxNumberOfPhotos:4})},xCUF:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return I})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return A}));n("IAdD"),n("JtPf"),n("kYxP");var a=n("LdEA"),s=n.n(a),r=n("oEOe"),i=n("aWyx"),o=n("k6jb"),c=n("AQ79"),d=n("uKEd"),u=n("xPna"),l=n("lRnM"),_=n("WVrH"),p=n("P1r1");const m=r.a(c.b,"FETCH_UPDATES"),b={isLoaded:!1,isLoading:!1};function E(e=b,t){switch(t.type){case m.REQUEST:return Object.assign({},e,{isLoading:!0});case m.FAILURE:return Object.assign({},e,{error:t.payload,isLoaded:!1,isLoading:!1});case m.SUCCESS:{const t=s()(e,["error"]);return Object.assign({},t,{isLoaded:!0,isLoading:!1})}case f:return Object.assign({},e,{cursor:t.payload});case h:return Object.assign({},e,{tertiaryInboxStatus:t.payload});case _.a:return b;default:return e}}const O=e=>(t,n,{api:a})=>{const i=n(),{directMessages:c={}}=i;let{cursor:d}=c.updates||{};const l=e||{},{polling:b}=l,E=s()(l,["polling"]),{tertiaryInboxStatus:O}=c.updates||{};let I=!1;const f=b?{"x-twitter-polling":"true"}:{},g=Object(p.q)(i),h=[Object(p.s)(n())?"on":"off",g?"on":"off"].join();O?O!==h&&(d=null,I=!0):I=!0;const A=Object(u.j)(Object.assign({},E,{muting_enabled:!0,nsfw_filtering_enabled:g,cursor:d}),n());return r.b(t,{params:A,headers:f,request:a.DirectMessages.fetchUserUpdates})({actionTypes:m,context:"FETCH_DM_USER_UPDATES",meta:{direction:Object(o.c)(e)}},e=>{if(e){const{entries:t,tweets:n,users:a,cards:s}=e.entities,{user_events:r,inbox_initial_state:i}=e.result;return[i&&Object(_.b)(),...Object(u.c)(Object.assign({},r||i,{entries:t,users:a,tweets:n,cards:s})),...r?v(Object.values(t||[])):[],I&&y(h)]}})},I=e=>(t,n)=>S(n())?Promise.resolve():t(O(e)),f=Object(c.c)("UPDATE_CURSOR"),g=e=>({payload:e,type:f}),h=Object(c.c)("UPDATE_TERTIARY_INBOX_STATUS"),y=e=>({payload:e,type:h}),v=(e=[])=>e.sort((e,t)=>e.id-t.id).reduce((e,t)=>{switch(t.type){case i.b.CONVERSATION_AVATAR_UPDATE:return[...e,Object(l.H)(t.conversation_id,t.conversation_avatar_image_https),Object(l.I)(t.conversation_id,t.id)].filter(e=>e);case i.b.CONVERSATION_NAME_UPDATE:return[...e,Object(l.K)(t),Object(l.I)(t.conversation_id,t.id)].filter(e=>e);case i.b.CONVERSATION_READ:return[...e,Object(l.q)(t.conversation_id,t.last_read_event_id)];case i.b.DISABLE_NOTIFICATIONS:case i.b.ENABLE_NOTIFICATIONS:{const n=t.type===i.b.ENABLE_NOTIFICATIONS;return[...e,Object(l.F)(t.conversation_id,n)]}case i.b.MARK_ALL_AS_READ:return[...e,Object(l.p)(t.last_read_event_id)];case i.b.MESSAGE_DELETE:return[...e,Object(d.i)(t.conversation_id,t.messages.reduce((e,t)=>[...e,...Object.values(t)],[]))];case i.b.MESSAGE_MARK_AS_NOT_SPAM:case i.b.MESSAGE_MARK_AS_SPAM:{const n=t.type===i.b.MESSAGE_MARK_AS_SPAM;return[...e,Object(d.r)(t.messages.reduce((e,t)=>[...e,...Object.values(t)],[]),n)]}case i.b.REMOVE_CONVERSATION:return[...e,...Object(l.t)(t.conversation_id)];case i.b.JOIN_CONVERSATION:case i.b.PARTICIPANTS_JOIN:case i.b.PARTICIPANTS_LEAVE:return[...e,Object(l.I)(t.conversation_id,t.id)];case i.b.REACTION_CREATE:return[...e,Object(d.g)(t),Object(d.c)(t),Object(l.I)(t.conversation_id,t.id)];case i.b.REACTION_DELETE:return[...e,Object(d.g)(t)];case i.b.MESSAGE:return[...e,Object(l.I)(t.conversation_id,t.id)].filter(e=>e);default:return e}},[]),A=e=>e[c.a].updates,S=e=>A(e).isLoading},xPna:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return T})),n.d(t,"d",(function(){return C})),n.d(t,"j",(function(){return N})),n.d(t,"t",(function(){return w})),n.d(t,"p",(function(){return U})),n.d(t,"o",(function(){return L})),n.d(t,"w",(function(){return V})),n.d(t,"y",(function(){return k})),n.d(t,"q",(function(){return B})),n.d(t,"s",(function(){return F})),n.d(t,"r",(function(){return G})),n.d(t,"n",(function(){return K})),n.d(t,"u",(function(){return z})),n.d(t,"z",(function(){return W})),n.d(t,"v",(function(){return Q})),n.d(t,"x",(function(){return Y})),n.d(t,"e",(function(){return J})),n.d(t,"f",(function(){return Z})),n.d(t,"h",(function(){return ee})),n.d(t,"i",(function(){return te})),n.d(t,"g",(function(){return ne})),n.d(t,"c",(function(){return re})),n.d(t,"D",(function(){return ie})),n.d(t,"E",(function(){return oe})),n.d(t,"C",(function(){return ce})),n.d(t,"m",(function(){return ue})),n.d(t,"B",(function(){return pe})),n.d(t,"l",(function(){return me})),n.d(t,"A",(function(){return Oe})),n.d(t,"k",(function(){return Ie}));n("IAdD"),n("JtPf"),n("kYxP");var a=n("LdEA"),s=n.n(a),r=n("oEOe"),i=n("/kEJ"),o=n("uKEd"),c=n("4q8G"),d=n("kGix"),u=n("aWyx"),l=n("WVrH"),_=n("xCUF"),p=n("AQ79"),m=n("lRnM"),b=n("tn7R"),E=n("YeIG"),O=n("t0aI"),I=n("P1r1");const f=r.a(p.b,"FETCH_INBOX"),g=r.a(p.b,"UPDATE_LAST_SEEN_EVENT_ID"),h="inbox",y="trusted",v="untrusted",A="untrusted_low_quality",S=Object.freeze({CLOSED:"closed",COLLAPSED:"collapsed",EXPANDED:"expanded"}),T={primary:"primary",secondary:"secondary",tertiary:"tertiary"},j={cursors:{[h]:{fetchStatus:d.a.NONE},[y]:{fetchStatus:d.a.NONE},[v]:{fetchStatus:d.a.NONE},[A]:{fetchStatus:d.a.NONE}},lastSeenEventIds:{},poppedOutConversationId:null,drawerVisibility:S.COLLAPSED,drawerExperimentEnabled:!1};function C(e=j,t){switch(t.type){case f.REQUEST:{const{timelineType:n}=t.meta;return Object.assign({},e,{cursors:Object.assign({},e.cursors,{[n]:Object.assign({},e.cursors[n],{fetchStatus:d.a.LOADING})})})}case f.FAILURE:{const{timelineType:n}=t.meta;return Object.assign({},e,{cursors:Object.assign({},e.cursors,{[n]:Object.assign({},e.cursors[n],{error:t.payload,fetchStatus:d.a.FAILED})})})}case f.SUCCESS:{const{timelineType:n}=t.meta;return Object.assign({},e,{cursors:Object.assign({},e.cursors,{[n]:Object.assign({},e.cursors[n],{error:void 0,fetchStatus:d.a.LOADED})})})}case ae:return Object.assign({},e,{cursors:Object.assign({},e.cursors,t.payload.cursors),lastSeenEventIds:R(e.lastSeenEventIds,t.payload.lastSeenEventIds)});case g.REQUEST:return Object.assign({},e,{lastSeenEventIds:Object.assign({},e.lastSeenEventIds,t.meta.lastSeenEventIds)});case l.a:return Object.assign({},j,{cursors:Object.assign({},j.cursors,{inbox:e.cursors.inbox})});case de:return Object.assign({},e,{poppedOutConversationId:t.conversationId,drawerVisibility:S.EXPANDED});case le:return Object.assign({},e,{drawerVisibility:t.visibility});case be:return Object.assign({},e,{drawerExperimentEnabled:t.enabled});default:return e}}const R=(e,t)=>({last_seen_event_id:D(e.last_seen_event_id,t.last_seen_event_id),trusted_last_seen_event_id:D(e.trusted_last_seen_event_id,t.trusted_last_seen_event_id),untrusted_last_seen_event_id:D(e.untrusted_last_seen_event_id,t.untrusted_last_seen_event_id)}),D=(e,t)=>Object(O.c)(e,t)?e:t,N=(e,t,n="all")=>{const a=Object(I.s)(t),s=Object(I.r)(t);return a?Object.assign({},e,{filter_low_quality:s,include_quality:n}):e},M=e=>e[p.a].inbox,x=e=>M(e).cursors,P=e=>M(e).lastSeenEventIds,w=e=>M(e).poppedOutConversationId,U=e=>M(e).drawerVisibility,L=e=>M(e).drawerExperimentEnabled,V=e=>x(e)[v],k=e=>x(e)[A],B=e=>(e=>x(e)[h])(e).fetchStatus,F=e=>B(e)===d.a.LOADING,G=e=>B(e)===d.a.LOADED,q={[T.primary]:e=>e.trusted,[T.secondary]:(e,t,n)=>t?!(e.trusted||e.muted||n&&e.nsfw||e.low_quality):!(e.trusted||e.muted||n&&e.nsfw),[T.tertiary]:(e,t,n)=>t?!e.trusted&&(e.muted||e.low_quality||n&&e.nsfw):!e.trusted&&(e.muted||n&&e.nsfw)},H=(e,t)=>{const n=Object(I.r)(e),a=Object(I.q)(e);return Object(b.a)(Object(m.C)(e)).filter(e=>q[t](e.data,n,a))},K=(e,t)=>H(e,t).map(e=>e.data).sort(c.a).map(e=>e.conversation_id),z=e=>{const t=H(e,T.primary),n=H(e,T.secondary),a=t.concat(n),{last_seen_event_id:s}=P(e);return X(e,a,s)},W=e=>{const t=H(e,T.secondary),{untrusted_last_seen_event_id:n}=P(e);return X(e,t,n)},Q=e=>{const t=H(e,T.secondary),n=H(e,T.tertiary);return t.length+n.length},Y=e=>H(e,T.tertiary).length,X=(e,t,n)=>n?t.reduce((t,{data:{conversation_id:a}})=>{const s=Object(m.B)(e,a),r=Object(m.A)(e,a);return s&&Object(O.b)(s,n)&&!r?t+1:t},0):0,J=(e={})=>(t,n,{api:a})=>{const s=n(),i=Object(I.q)(s),o=N(Object.assign({muting_enabled:!0,nsfw_filtering_enabled:i},e),n());return r.b(t,{params:o,request:a.DirectMessages.fetchUserInbox})({actionTypes:f,context:"FETCH_DM_INBOX",meta:{timelineType:h}},e=>{if(e){const{entries:t,users:n,tweets:a,cards:s}=e.entities;return re(Object.assign({},e.result.inbox_initial_state,{entries:t,users:n,tweets:a,cards:s}))}})},Z=(e={})=>(t,n)=>{const a=n(),s=B(a);return s!==d.a.LOADED&&s!==d.a.LOADING?t(J(e)):Promise.resolve()},$=(e,t,n=0)=>(a,s,{api:i})=>{const o=s(),c=Object(I.q)(o),{status:d,min_entry_id:l}=x(o)[e],_=e===A?v:e,p=Object.assign({},t,{max_id:l,timelineType:_,muting_enabled:e!==y,nsfw_filtering_enabled:c});if(d!==u.c.HAS_MORE)return Promise.resolve();return r.b(a,{params:p,request:i.DirectMessages.fetchInboxHistory})({actionTypes:f,context:"FETCH_DM_INBOX_HISTORY",meta:{timelineType:e}},t=>{if(t){const{entries:n,users:a,tweets:s,cards:r}=t.entities,{inbox_timeline:i}=t.result;return re({conversations:i.conversations,inbox_timelines:{[e]:i},entries:n,users:a,tweets:s,cards:r})}}).then(s=>{const r=s.result.inbox_timeline;if(n<3&&!r.conversations&&r.status===u.c.HAS_MORE)return a($(e,t,n+1))})},ee=e=>(t,n)=>{const a=N(e,n(),"high");return t($(v,a))},te=e=>(t,n)=>{const a=N(e,n(),"low");return t($(A,a))},ne=e=>(t,n)=>{const a=N(e,n());return t($(y,a))},ae=Object(p.c)("UPDATE_INBOX"),se=e=>{const{inbox_timelines:t}=e;return{payload:{cursors:t,lastSeenEventIds:s()(e,["inbox_timelines"])},type:ae}},re=(e={})=>{const{conversations:t,entries:n,users:a,tweets:r,cards:c,cursor:d}=e,u=s()(e,["conversations","entries","users","tweets","cards","cursor"]);return[Object(i.c)({cards:c,tweets:r,users:a}),!Object(E.a)(t)&&Object(m.c)(t),!Object(E.a)(n)&&Object(o.a)(n),!Object(E.a)(d)&&Object(_.f)(d),!Object(E.a)(u)&&se(u)].filter(e=>e)},ie=()=>e=>e(ce({withTrusted:!0})),oe=()=>e=>e(ce({withUntrusted:!0})),ce=({withTrusted:e,withUntrusted:t}={})=>(n,a,{api:s})=>{const i=a(),o=Object(m.C)(i),c=P(i),{last_seen_event_id:d,trusted_last_seen_event_id:u,untrusted_last_seen_event_id:l}=c,_=Object.values(o).reduce((e,{data:{sort_event_id:t,trusted:n}})=>(e.last_seen_event_id=D(e.last_seen_event_id,t),e.trusted_last_seen_event_id=n?D(e.trusted_last_seen_event_id,t):e.trusted_last_seen_event_id,e.untrusted_last_seen_event_id=n?e.untrusted_last_seen_event_id:D(e.untrusted_last_seen_event_id,t),e),Object.assign({},c));if(Object(O.b)(_.last_seen_event_id,d)||e&&Object(O.b)(_.trusted_last_seen_event_id,u)||t&&Object(O.b)(_.untrusted_last_seen_event_id,l)){e||delete _.trusted_last_seen_event_id,t||delete _.untrusted_last_seen_event_id;return r.c(n,{params:_,request:s.DirectMessages.updateLastSeenEventId})({actionTypes:g,context:"APP_DM_UPDATE_LAST_SEEN",meta:{lastSeenEventIds:_}})}return Promise.resolve()},de=Object(p.c)("POP_OUT_CONVERSATION"),ue=e=>(t,n,{userPersistence:a})=>(a.set("rweb.dmDrawerVisibility",{visibility:S.EXPANDED}),t({conversationId:e,type:de})),le=Object(p.c)("SET_DRAWER_VISIBILITY"),_e=e=>({visibility:e,type:le}),pe=e=>(t,n,{userPersistence:a})=>(a.set("rweb.dmDrawerVisibility",{visibility:e}),e===S.CLOSED&&t({type:de}),t(_e(e))),me=()=>(e,t,{userPersistence:n})=>n.get("rweb.dmDrawerVisibility").then(t=>{t&&e(_e(t.visibility))}),be=Object(p.c)("SET_DRAWER_EXPERIMENT_ENABLED"),Ee=e=>({enabled:e,type:be}),Oe=e=>(t,n,{userPersistence:a})=>(a.set("rweb.dmQuickAccessEnabled",{enabled:e}),t(Ee(e))),Ie=()=>(e,t,{userPersistence:n})=>n.get("rweb.dmQuickAccessEnabled").then(t=>{t&&e(Ee(t.enabled))})}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.DMDrawer~bundle.Compose~bundle.RichTextCompose~bundle.DirectMessages~bundle.DMRichTextCompose~b.80a7f445.js.map